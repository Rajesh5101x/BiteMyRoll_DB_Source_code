{% extends 'layout.html' %}

{% block content %}
<style>
    a{
        text-decoration: none;
    }
    h1 {
        color: #FFAE36;
        padding-bottom: 5px;
        font-size: 2.7rem;
        text-align: center; 
    }

    .content-section{
        min-height: 79.7vh;
        padding-bottom: 20px;
    }
    .roll-card-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 2rem;
        margin-top: 2rem;
    }

    .roll-card {
        background-color: #1a1a1a;
        border-radius: 8px;
        overflow: hidden;
        width: 292px;
        color: #f1f1f1;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        transition: transform 0.6s ease, box-shadow 0.6s ease
    }

    .roll-card:hover {
        transform: translateY(-6px);
        animation: twinkle-shadow 2s infinite alternate;
    }

    /* Twinkling shadow animation */
    @keyframes twinkle-shadow {
        0% {
            box-shadow: 0 4px 15px 2px rgba(255, 157, 45, 0.2);
        }
        50% {
            box-shadow: 0 6px 20px 4px rgba(255, 157, 45, 0.6);
        }
        100% {
            box-shadow: 0 4px 12px 2px rgba(255, 157, 45, 0.3);
        }
    }

    .roll-card img {
        width: 100%;
        height: 463px;
        object-fit: cover;
    }

    .roll-card h3 {
        color: #FFAE36;
        margin: 0.75rem 0 0.5rem;
    }

    .roll-card p {
        padding: 0 1rem 0rem;
        font-size: 0.95rem;
        color: #ccc;
    }

    @media (max-width: 768px) {
        .roll-card-container {
        flex-direction: row;
        align-items: start;
        }
        .roll-card{
            width: 42vw;
        }

        .roll-card img {
        width: 100%;
        height: auto;
        }

        h1{
            font-size: 15px;
        }
        .roll-card h3{
            font-size: 13px;
            margin: 5px
        }

        .roll-card p{
            font-size: 7px;
            margin: 0px 0px;
        }
        .diet-badge{
            font-size: 10px;
        }
    }
    .diet-badge{
        position: absolute;
        padding: 10px;
    }

    h1, h2, h3, h4, h5, h6 {
  font-size: revert;
  font-weight: revert;
}

.add-card-vertical {
  border: 2px dashed #ccc;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  color: #888;
  font-weight: 600;
  cursor: pointer;
  transition: border-color 0.3s, color 0.3s;
}

.add-card-vertical:hover {
  border-color: #ffae36;
  color: #ffae36;
}

.add-card-content {
  text-align: center;
}

.plus-sign {
  font-size: 2rem;
  margin-bottom: 0.3rem;
}



.roll-card.unavailable {
    opacity: 0.5;
    pointer-events: none;
}
.roll-card.unavailable .admin-controls {
    pointer-events: auto; /* keep admin controls clickable */
}


</style>

<section class="content-section">
  <h1>Explore Our Beverages</h1>
  <div class="roll-card-container">
    {% for drink in drinks %}
        {% set has_available = drink.sizes | selectattr('is_available') | list | length > 0 %}

        {% if current_user.is_authenticated and current_user.is_admin == 1 %}
            <a href="{{ url_for('admin_drinks_detail', drink_key=drink.name) }}">
                <div class="roll-card {% if not has_available %}unavailable{% endif %}">
                    <img src="{{ url_for('static', filename=drink.image or 'images/placeholder.png') }}" alt="{{ drink.name }}">
                    <h3>{{ drink.name }}</h3>
                    <p>{{ drink.description }}</p>

                    <div class="admin-controls">
                        <form method="post" action="{{ url_for('toggle_drink_availability', drink_id=drink.id) }}"
                              onsubmit="return confirm('Change availability?')">
                            <label>
                                <input type="checkbox" name="is_available" value="1"
                                       onchange="this.form.submit()"
                                       {% if has_available %}checked{% endif %}>
                                Available
                            </label>
                        </form>

                        <form method="post" action="{{ url_for('delete_drink', drink_id=drink.id) }}"
                              onsubmit="return confirm('Are you sure you want to delete this drink?')">
                            <button type="submit" style="background:red; color:white;">Delete Drink</button>
                        </form>
                    </div>
                </div>
            </a>

        {% else %}
            {% if has_available %}
                <a href="{{ url_for('drinks_detail', drink_key=drink.name) }}">
                    <div class="roll-card">
                        <img src="{{ url_for('static', filename=drink.image or 'images/placeholder.png') }}" alt="{{ drink.name }}">
                        <h3>{{ drink.name }}</h3>
                        <p>{{ drink.description }}</p>
                    </div>
                </a>
            {% endif %}
        {% endif %}
    {% endfor %}

    {% if current_user.is_authenticated and current_user.is_admin == 1 %}
    <a href="{{ url_for('admin_add_drink') }}" 
    class="block w-full md:w-60">
    <div class="flex flex-col items-center justify-center border-2 border-dashed border-gray-400 rounded-2xl p-6 h-40 
                text-gray-500 hover:border-yellow-400 hover:text-yellow-500 transition-colors duration-300 shadow-sm hover:shadow-lg"
            style="height: -webkit-fill-available;">
        <i class="fas fa-plus-circle text-3xl mb-2"></i>
        <p class="font-semibold">Add New Drink</p>
    </div>
    </a>
    {% endif %}



  </div>

  
</section>
{% endblock %}